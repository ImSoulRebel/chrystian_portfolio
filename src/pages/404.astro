---
/**
 * 404 Root Handler
 * Esta página maneja las solicitudes 404 y redirige al usuario a la versión localizada
 * basándose en las preferencias de idioma del navegador.
 *
 * Las páginas 404 localizadas están en:
 * - /es/404 para español
 * - /en/404 para inglés
 *
 * Nota: Usa detección de idioma del lado del cliente para sitios estáticos (Astro 5.x)
 */

import { getRelativeLocaleUrl } from 'astro:i18n';
import { LoadingSection } from '@sections';
import '@styles/global.css';

// Para sitios estáticos, la detección de idioma se hace del lado del cliente
const esUrl = getRelativeLocaleUrl('es', '/404');
const enUrl = getRelativeLocaleUrl('en', '/404');
---

<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Redirecting...</title>
    <script is:inline define:vars={{ esUrl, enUrl }}>
      // Detectar idioma preferido del navegador en el cliente
      const browserLang = navigator.language || navigator.userLanguage || '';
      const preferredLocale = browserLang.toLowerCase().startsWith('es')
        ? 'es'
        : 'en';
      const redirectUrl = preferredLocale === 'es' ? esUrl : enUrl;

      // Redirigir inmediatamente
      window.location.replace(redirectUrl);
    </script>
    <noscript>
      <meta http-equiv="refresh" content="0;url={esUrl}" />
    </noscript>
  </head>
  <body>
    <LoadingSection message="Redirecting..." />
  </body>
</html>
