---
/**
 * 404 Root Handler
 * Esta página maneja las solicitudes 404 y redirige al usuario a la versión localizada
 * basándose en las preferencias de idioma del navegador.
 *
 * Las páginas 404 localizadas están en:
 * - /es/404 para español
 * - /en/404 para inglés
 */

import { getRelativeLocaleUrl } from 'astro:i18n';

// Detectar idioma preferido del navegador
const acceptLanguage = Astro.request.headers.get('accept-language') || '';
const preferredLocale =
  acceptLanguage.toLowerCase().includes('en') &&
  !acceptLanguage.toLowerCase().startsWith('es')
    ? 'en'
    : 'es';

// Redirigir a la página 404 localizada
// getRelativeLocaleUrl incluye automáticamente el base path configurado
// @ts-ignore - TypeScript doesn't detect usage in Astro.redirect return statement
const redirectUrl = getRelativeLocaleUrl(preferredLocale, '/404');
return Astro.redirect(redirectUrl, 302);
---
