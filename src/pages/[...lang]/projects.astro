---
import { PUBLIC_AUTHOR_NAME } from 'astro:env/client';
import { Layout } from '@layouts';
import { Header, Footer, ProjectCard, BackToHome } from '@components';
import { useTranslations, type Locale, translations } from '@utils/i18n';
import * as assets from '@assets';

// Define static paths for both languages
export async function getStaticPaths() {
  return [
    { params: { lang: 'es' } }, // /es/projects
    { params: { lang: 'en' } }, // /en/projects
  ];
}

// Get the language from params
const { lang } = Astro.params;
const locale = (lang as Locale) || 'es';
const t = useTranslations(locale);
const hasNavLinks = false;

// SEO content from centralized translations
const pageTitle = `${t('projects.seo.title')} | ${PUBLIC_AUTHOR_NAME}`;
const pageDescription = t<string>('projects.seo.description');

// Tipo para las claves de proyectos
type ProjectKey = 'yuvod' | 'nextival' | 'stelcamping' | 'bnc10' | 'tookane';

// Tipo para los proyectos combinados
type Project = {
  title: string;
  stack: string;
  description: string;
  impact: string;
  featured: boolean;
  liveUrl?: string | undefined;
  githubUrl?: string | undefined;
  image: any;
};

// Configuración de proyectos empresariales B2B
const businessProjectsConfig: Array<{
  key: ProjectKey;
  priority: number;
  featured: boolean;
  liveUrl?: string;
  githubUrl?: string;
  image: any;
}> = [
  {
    key: 'yuvod',
    priority: 1,
    featured: true,
    liveUrl: 'https://yuvod.com',
    image: assets.yuvodLogo,
  },
  {
    key: 'bnc10',
    priority: 2,
    featured: true,
    image: assets.bnc10Logo,
  },
  {
    key: 'tookane',
    priority: 3,
    featured: true,
    liveUrl: 'https://tookane.com',
    image: assets.tookaneLogo,
  },
  {
    key: 'stelcamping',
    priority: 4,
    featured: false,
    liveUrl: 'https://stel.es',
    image: assets.stelLogo,
  },
];

// Configuración de proyectos personales
const personalProjectsConfig: Array<{
  key: ProjectKey;
  priority: number;
  featured: boolean;
  liveUrl?: string;
  githubUrl?: string;
  image: any;
}> = [
  {
    key: 'nextival',
    priority: 1,
    featured: false,
    githubUrl: 'https://github.com/ImSoulRebel/nextival-cms',
    image: assets.nextivalLogo,
  },
];

// Construir proyectos empresariales
const businessProjects: Project[] = businessProjectsConfig.map((config) => {
  const projectData = translations[locale as Locale].projects.list[config.key];
  if (!projectData) {
    throw new Error(`Missing project data for key: ${config.key}`);
  }
  return {
    title: projectData.title,
    stack: projectData.stack,
    description: projectData.description,
    impact: projectData.impact,
    featured: config.featured,
    liveUrl: config.liveUrl,
    githubUrl: config.githubUrl,
    image: config.image,
  };
});

// Construir proyectos personales
const personalProjects: Project[] = personalProjectsConfig.map((config) => {
  const projectData = translations[locale as Locale].projects.list[config.key];
  if (!projectData) {
    throw new Error(`Missing project data for key: ${config.key}`);
  }
  return {
    title: projectData.title,
    stack: projectData.stack,
    description: projectData.description,
    impact: projectData.impact,
    featured: config.featured,
    liveUrl: config.liveUrl,
    githubUrl: config.githubUrl,
    image: config.image,
  };
});

// Separar proyectos destacados empresariales
const featuredBusinessProjects = businessProjects.filter((p) => p.featured);
const regularBusinessProjects = businessProjects.filter((p) => !p.featured);
---

<Layout title={pageTitle} description={pageDescription} locale={locale} floatingCTAMode="navigate-to-contact">
  <!-- Back to Home Button -->
  <BackToHome locale={locale} />
  
  <Header hasNavLinks={hasNavLinks} locale={locale} />

  <main class="projects-page">
    <!-- Hero Section -->
    <section class="projects-hero">
      <div class="container">
        <div class="hero-content">
          <h1 class="hero-title">
            {locale === 'es' ? 'Todos los Proyectos' : 'All Projects'}
          </h1>
          <p class="hero-description">
            {
              locale === 'es'
                ? 'Portafolio completo de soluciones Flutter multiplataforma, arquitecturas escalables y liderazgo técnico en desarrollo móvil y SmartTV.'
                : 'Complete portfolio of cross-platform Flutter solutions, scalable architectures, and technical leadership in mobile and SmartTV development.'
            }
          </p>
        </div>
      </div>
    </section>

    <!-- Business Projects B2B -->
    <section class="business-projects-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">
            {
              locale === 'es'
                ? 'Proyectos Empresariales B2B'
                : 'B2B Business Projects'
            }
          </h2>
          <p class="section-description">
            {
              locale === 'es'
                ? 'Soluciones Flutter desarrolladas para empresas, con arquitecturas escalables y alto impacto comercial.'
                : 'Flutter solutions developed for enterprises, featuring scalable architectures and high commercial impact.'
            }
          </p>
        </div>

        <!-- Featured Business Projects -->
        <div class="subsection">
          <h3 class="subsection-title">
            {locale === 'es' ? 'Proyectos Destacados' : 'Featured Projects'}
          </h3>
          <div class="projects-grid featured-grid">
            {
              featuredBusinessProjects.map((project: Project) => (
                <ProjectCard
                  title={project.title}
                  stack={project.stack}
                  description={project.description}
                  impact={project.impact}
                  featured={project.featured}
                  liveUrl={project.liveUrl}
                  githubUrl={project.githubUrl}
                  image={project.image}
                  locale={locale}
                />
              ))
            }
          </div>
        </div>

        <!-- Other Business Projects -->
        {
          regularBusinessProjects.length > 0 && (
            <div class="subsection">
              <h3 class="subsection-title">
                {locale === 'es'
                  ? 'Otros Proyectos Empresariales'
                  : 'Other Business Projects'}
              </h3>
              <div class="projects-grid regular-grid">
                {regularBusinessProjects.map((project: Project) => (
                  <ProjectCard
                    title={project.title}
                    stack={project.stack}
                    description={project.description}
                    impact={project.impact}
                    featured={project.featured}
                    liveUrl={project.liveUrl}
                    githubUrl={project.githubUrl}
                    image={project.image}
                    locale={locale}
                  />
                ))}
              </div>
            </div>
          )
        }
      </div>
    </section>

    <!-- Personal Projects -->
    <section class="personal-projects-section">
      <div class="container">
        <div class="section-header">
          <h2 class="section-title">
            {locale === 'es' ? 'Proyectos Personales' : 'Personal Projects'}
          </h2>
          <p class="section-description">
            {
              locale === 'es'
                ? 'Desarrollos propios que demuestran creatividad, experimentación con nuevas tecnologías y pasión por la innovación.'
                : 'Own developments that showcase creativity, experimentation with new technologies, and passion for innovation.'
            }
          </p>
        </div>
        <div class="projects-grid personal-grid">
          {
            personalProjects.map((project: Project) => (
              <ProjectCard
                title={project.title}
                stack={project.stack}
                description={project.description}
                impact={project.impact}
                featured={project.featured}
                liveUrl={project.liveUrl}
                githubUrl={project.githubUrl}
                image={project.image}
                locale={locale}
              />
            ))
          }
        </div>
      </div>
    </section>
  </main>

  <Footer hasNavLinks={hasNavLinks} locale={locale} />
</Layout>

<style>
  .projects-page {
    min-height: 100vh;
    background: var(--background-dark);
  }

  /* Hero Section */
  .projects-hero {
    padding: 8rem 0 4rem;
    background: linear-gradient(
      135deg,
      var(--background-dark) 0%,
      var(--accent-color) 100%
    );
    position: relative;
    overflow: hidden;
  }

  .projects-hero::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: radial-gradient(
      circle at 30% 20%,
      rgba(0, 212, 255, 0.1) 0%,
      transparent 50%
    );
  }

  .hero-content {
    text-align: center;
    max-width: 800px;
    margin: 0 auto;
    position: relative;
    z-index: 1;
  }

  .hero-title {
    font-size: clamp(3rem, 6vw, 4.5rem);
    background: var(--gradient-primary);
    background-clip: text;
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    margin-bottom: 1.5rem;
    font-weight: 800;
    letter-spacing: -0.02em;
  }

  .hero-description {
    font-size: 1.3rem;
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 0;
  }

  /* Section Styles */
  .business-projects-section {
    padding: 6rem 0;
    background: linear-gradient(
      135deg,
      transparent 0%,
      rgba(0, 212, 255, 0.03) 100%
    );
  }

  .personal-projects-section {
    padding: 4rem 0 6rem;
    background: linear-gradient(
      135deg,
      rgba(0, 212, 255, 0.05) 0%,
      transparent 100%
    );
    border-top: 1px solid rgba(0, 212, 255, 0.1);
  }

  .section-header {
    text-align: center;
    margin-bottom: 4rem;
    max-width: 800px;
    margin-left: auto;
    margin-right: auto;
  }

  .section-title {
    font-size: clamp(2.5rem, 4vw, 3rem);
    margin-bottom: 1.5rem;
    color: var(--text-primary);
    font-weight: 700;
  }

  .section-description {
    font-size: 1.2rem;
    color: var(--text-secondary);
    line-height: 1.6;
    margin-bottom: 0;
  }

  .subsection {
    margin-bottom: 4rem;
  }

  .subsection:last-child {
    margin-bottom: 0;
  }

  .subsection-title {
    font-size: 1.8rem;
    color: var(--primary-color);
    margin-bottom: 2rem;
    text-align: center;
    font-weight: 600;
  }

  /* Grid Layouts */
  .projects-grid {
    display: grid;
    gap: 2.5rem;
    justify-items: center;
    align-items: start;
  }

  .featured-grid {
    grid-template-columns: repeat(3, 1fr);
  }

  .regular-grid {
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  }

  .personal-grid {
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
  }

  /* Responsive Design */
  @media (max-width: 1200px) {
    .featured-grid {
      grid-template-columns: repeat(3, 1fr);
      gap: 2rem;
    }

    .regular-grid,
    .personal-grid {
      grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    }
  }

  @media (max-width: 900px) {
    .featured-grid {
      grid-template-columns: repeat(2, 1fr);
    }

    .regular-grid,
    .personal-grid {
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    }
  }

  @media (max-width: 768px) {
    .projects-hero {
      padding: 6rem 0 3rem;
    }

    .hero-description,
    .section-description {
      font-size: 1.1rem;
    }

    .business-projects-section,
    .personal-projects-section {
      padding: 4rem 0;
    }

    .section-header {
      margin-bottom: 3rem;
    }

    .subsection {
      margin-bottom: 3rem;
    }

    .projects-grid {
      grid-template-columns: 1fr;
      gap: 1.8rem;
    }
  }

  @media (max-width: 600px) {
    .featured-grid,
    .regular-grid,
    .personal-grid {
      grid-template-columns: 1fr;
      gap: 1.5rem;
    }
  }

  @media (max-width: 480px) {
    .projects-hero {
      padding: 5rem 0 2.5rem;
    }

    .projects-grid {
      gap: 1.5rem;
    }

    .subsection-title {
      font-size: 1.5rem;
    }
  }
</style>
